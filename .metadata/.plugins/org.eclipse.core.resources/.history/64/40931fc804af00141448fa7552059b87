package test;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;

import javax.annotation.PostConstruct;
import javax.enterprise.context.Conversation;
import javax.enterprise.context.ConversationScoped;
import javax.enterprise.inject.Default;
import javax.faces.context.FacesContext;
import javax.inject.Inject;
import javax.inject.Named;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import clases.vo.cliente.Cliente;

@Named
@ConversationScoped
@Default
public class CompraView implements Serializable{
		
	
	 /**
	 * 
	 */
	private static final long serialVersionUID = 2732432874569849246L;
	
	private final Logger logger = LogManager.getLogger(CompraView.class);
	
	private int numeroArticolo=0;
	
	@Inject
	 private Conversation conversation;
	
	private List<Articulo> articulos;
	private Cliente cliente;
	
	public CompraView() {
		
	}
	
	@PostConstruct
	private void init(){
		System.out.println("INIT compraView");
		this.articulos= new ArrayList<Articulo>();
		this.cliente= new Cliente();
	}

	public void initConversation(){
	    if (!FacesContext.getCurrentInstance().isPostback() 
	      && conversation.isTransient()) {
	      System.out.println("Inicia convesacion en clase");
	      conversation.begin();
	    }
	  }
	
	 public String endConversation(){
		    if(!conversation.isTransient()){
		      conversation.end();
		    }
		    return "cotizacion?faces-redirect=true";
		  }

	public Conversation getConversation() {
		return conversation;
	}

	public void setConversation(Conversation conversation) {
		this.conversation = conversation;
	}

	public List<Articulo> getArticulos() {
		return articulos;
	}

	public void setArticulos(List<Articulo> articulos) {
		this.articulos = articulos;
	}

	public Cliente getCliente() {
		return cliente;
	}

	public void setCliente(Cliente cliente) {
		this.cliente = cliente;
	}
	
	public int getNumeroArtculo(){
		return ++this.numeroArticolo;
	}
	 
	 
}
